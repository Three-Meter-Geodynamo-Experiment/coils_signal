function [voltage] = coils_signal(I,var_type)
%COILS_SIGNAL returns average voltage on 33 probes that comes from external coils
%   type corresponds to the configuration of the external field
%   1 - one coil: stationary sphere experiment: 050914 with magnetic ramp with one external coil
%   2 - two coils dipolar north up:  032516 ro = 0, fo=4, I ~ 20 and I = 0;  200 Amps that day don't look good, 
%   3 - two coils quadrupolar equator north: based on 032416 with -3.7 Hz and three mag fields with I = 0 20 170
%   4 - two coils dipolar north up:  082616 ro = 0, fo = 0.2, mag ramp up to 170, don't like this cuz the phi probe linearly depend ons current
%   5 - two coils quadrupolar equator north 082616 ro = 0, fo = 0.2, mag ramp,up to 160, phi probe seems misaligned compared with (3), but the rest seems good
%   6 - two coils dipolar north up, 101816, fixed sphere, mag ramp up to
%   240
%   Artur Perevalov 
%   September 2019

% alpha contains coefficients in an assumpltion: V = I*alpha, 

alpha = zeros(7,35);
alpha(1,1:33) = [-0.00860649327045131,-0.00863409894544341,-0.00864885157801721,-0.00908172559437671,-0.0128835154999633,-0.0123877570033905,-0.0125143232727633,-0.0126676697557432,-0.0126893569640319,-0.0117423337854309,-0.0125954370737819,-0.00643940959632284,-0.00693285907733849,-0.00897908908072721,-0.00966341749530463,-0.00430645195610559,-0.00444585255565992,-0.00501729934390688,-0.00558842992860838,-0.00504852572809718,0.0140199970898809,0.0135535599231505,0.0146885830957521,0.0146466949960560,0.0147691165001943,0.0151353538910077,0.0151768040120911,0.00923750531373018,0.00979743553354835,0.00936428918255543,0.0110744387487688,0.00179096717467095,0.000589703522562749];
alpha(2,1:33) = [-0.0183242929430680,-0.0182304897794983,-0.0183713676882206,-0.0179220653000074,-0.0250088711704524,-0.0235740470364744,-0.0246897164399814,-0.0247876462580479,-0.0207100476835801,-0.0232190429686641,-0.0232976374151186,0.000805106154222929,0.000860180479769712,-0.000106157480647169,-6.40974867372084e-05,-0.00119376194962062,0.000342820159541341,0.000378592024363561,-0.000892081000222929,0.00111097241142074,0.0233237446738776,0.0238296977224089,0.0232348692669326,0.0231009796019143,0.0224051540985330,0.0231484274262059,0.0268973525128287,0.0188769614673215,0.0203105624975584,0.0198997351959505,0.0200673258924446,0.00269761800759877,0.000324321422359345];
alpha(3,1:33) = [-0.00739789191709710,-0.00736055717414688,-0.00736418987754479,-0.00724183073373852,-0.0101231644235459,-0.00930515204186043,-0.00997282217001000,-0.0101716615368997,-0.00460625524369814,-0.00944428164993996,-0.00943158680722120,0.0246483334437546,0.0239804660812739,0.0236238579661394,0.0234381887843995,0.0243019025469670,0.0245434327322534,0.0249226781303556,0.0238859157655795,0.0242092882805301,-0.00810320560267537,-0.00817668690967884,-0.00726521406961129,-0.00723805126613848,-0.00666902319261776,-0.00671526532590529,-0.0104804141456224,-0.00781292070752468,-0.00848318021702104,-0.00829594343050980,-0.00847774609085267,-0.000423366057843764,-4.78313480457657e-05];
alpha(4,1:33) = [-0.0192496422451192,-0.0190433691797039,-0.0189538978446071,-0.0187968245694034,-0.0257650052985487,-0.0246214476072301,-0.0255219112727282,-0.0259737532437336,-0.0216362596875124,-0.0242441886479728,-0.0243196795593140,0.000449083949487693,0.000832196242503565,-0.000107890323509899,-0.000473484615072432,-0.00108621664704375,0.000235811937049512,9.24111447534933e-06,-0.000740374607389510,0.00100380464480051,0.0249083709992570,0.0254230372714596,0.0247846688123953,0.0246764578955861,0.0246088417331558,0.0247294882233955,0.0287007342515881,0.0199806191717946,0.0212883077093641,0.0209550903607429,0.0211665087112134,0.0208731182358601,0.00342716738010356];
alpha(5,1:33) = [-0.00751204721685093,-0.00740784013825451,-0.00739963483782111,-0.00730468908631602,-0.0102546289626430,-0.00942355829280058,-0.0101311603035643,-0.0104375914715819,-0.00494670973839146,-0.00958602654134415,-0.00960001090963114,0.0243789432945489,0.0240118864011005,0.0236810121162523,0.0234487757669131,0.0243544865292822,0.0245875435499213,0.0250088304825850,0.0239404367009292,0.0241422008128913,-0.00824554271663599,-0.00837602636911582,-0.00758889535122761,-0.00748798801036985,-0.00711430946601326,-0.00689879293687265,-0.0106669026692581,-0.00772734673891867,-0.00840069453475691,-0.00820501549593380,-0.00840390616672074,-0.00843788067611005,-0.000740747680365803];
alpha(6,1:33) = [-0.0180391066619664,-0.0180638790120920,-0.0180729958491406,-0.0178218495646782,-0.0230081527336536,-0.0223066365867534,-0.0232532228443216,-0.0241298050959449,-0.0201713838302727,-0.0223143661592637,-0.0223947821032003,-0.000384441664561216,-3.20906376741638e-05,-0.000599500013421413,-0.000437865717979016,-0.000525627721176753,0.00122343300219167,0.000943436554151972,-0.000738464610081986,0.000336620380507906,0.0238378335743902,0.0240386011973480,0.0234552487210309,0.0227534857078610,0.0222939101573869,0.0233008833107207,0.0268394033227749,0.0194760548427553,0.0203581807011687,0.0204109826557572,0.0232209158463002,0.0227561059367878,0.00347697184421518];

alpha(7,1:35) = [-0.0187469339429200,-0.0186826055429915,-0.0185745560786170,-0.0182890995880526,-0.0247378568321998,-0.0240384696674062,-0.0254076784635126,-0.0261117770606221,-0.0265228647188861,-0.0236119093308692,-0.0235098755545402,-0.000155421997571969,0.000214694269189529,-0.000195731066694172,0.000208851376042607,-6.68958928655580e-05,0.00122748549859952,0.000608984684885051,-0.000925526066617511,-0.00568112298682214,0.0248622009903510,0.0252050608893165,0.0242043937282304,0.0234695835573433,0.0233073562817522,0.0248589234407468,0.0272633173420665,0.0191377306363158,0.0206155254347023,0.0208369124053482,0.0233930041833866,-0.00480389251953911,-3.45073345493733e-06,-0.00293624067565657,8.77574779879412e-05];

if var_type < 1 || var_type > size(alpha,1)
    voltage = zeros(1,35);
    warning('Bad type on input');
else
    voltage = I*alpha(var_type,:);
end

if var_type < 7
    voltage = voltage(1:33);
end

% if type == 1
%     
%     % this one is based on stationary sphere experiment on 050914 with
%     % magnetic ramp with one external coil
%     alpha = [-0.00860649327045131,-0.00863409894544341,-0.00864885157801721,-0.00908172559437671,-0.0128835154999633,-0.0123877570033905,-0.0125143232727633,-0.0126676697557432,-0.0126893569640319,-0.0117423337854309,-0.0125954370737819,-0.00643940959632284,-0.00693285907733849,-0.00897908908072721,-0.00966341749530463,-0.00430645195610559,-0.00444585255565992,-0.00501729934390688,-0.00558842992860838,-0.00504852572809718,0.0140199970898809,0.0135535599231505,0.0146885830957521,0.0146466949960560,0.0147691165001943,0.0151353538910077,0.0151768040120911,0.00923750531373018,0.00979743553354835,0.00936428918255543,0.0110744387487688,0.00179096717467095,0.000589703522562749];
% 
%     voltage = I*alpha;
%     return
%     
% elseif type == 2
%     
%     % based on 032516 ro = 0, fo=4, I ~ 200 and I =0;
%     alpha = [-0.0159436273030166,-0.0152172439514421,-0.0152235278889459,-0.0150003664251197,-0.0152890415910123,-0.0154553891840359,-0.0150880108693640,-0.0154935163179646,-0.0128154654972637,-0.0151227879841583,-0.0151311960209431,0.000598005874250849,0.000914381670853090,2.86027119846063e-05,-0.000335857164555337,-0.00112809319658417,0.000365800789124833,0.000129294119630683,-0.000564873751204034,0.00112531585738478,0.0195344331900172,0.0195932737902957,0.0191380589330467,0.0193716250002101,0.0194418341349501,0.0193142316116965,0.0194515542825971,0.0194826215541328,0.0190440723325903,0.0191960078964452,0.0192799360825656,0.00343157437736091,7.15705897161227e-05];
%     voltage = I*alpha;
% 
% elseif type == 3 
%     
%     % based on 032416 with -3.7 Hz and three mag fields with I = 0 20 170
%     alpha = [-0.00739789191709710,-0.00736055717414688,-0.00736418987754479,-0.00724183073373852,-0.0101231644235459,-0.00930515204186043,-0.00997282217001000,-0.0101716615368997,-0.00460625524369814,-0.00944428164993996,-0.00943158680722120,0.0246483334437546,0.0239804660812739,0.0236238579661394,0.0234381887843995,0.0243019025469670,0.0245434327322534,0.0249226781303556,0.0238859157655795,0.0242092882805301,-0.00810320560267537,-0.00817668690967884,-0.00726521406961129,-0.00723805126613848,-0.00666902319261776,-0.00671526532590529,-0.0104804141456224,-0.00781292070752468,-0.00848318021702104,-0.00829594343050980,-0.00847774609085267,-0.000423366057843764,-4.78313480457657e-05];
%     voltage = I*alpha;
% 
% else
%     voltage = zeros(1,33);
%     return
% end

end

